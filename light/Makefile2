CPP_SRC = io/input.cpp io/geom.cpp material.cpp io/output.cpp delta.cpp io/bf.cpp contact.cpp forces/forces.cpp dynamics.cpp io/log.cpp

CC=gcc
CXX=g++

HULLINC = -Iext/hul
HULLLIB = -Lext/hul -lhul

# Python paths
#PYTHONINC=-I/usr/include/python2.7
#PYTHONLIB=-L/usr/lib -lpython2.7

PYTHONINC = -I/Library/Frameworks/Python.framework/Versions/3.4/include/python3.4m/
PYTHONLIB = -L/Library/Frameworks/Python.framework/Versions/3.4/lib -lpython3.4

# Program name
EXE=delta

REAL=double

DEBUG=yes

ifeq ($(REAL),double)
  REAL=-DiREAL=double
else
  REAL=-DiREAL=float
endif

ifeq ($(DEBUG),yes)
  CFLAGS=-Iobjs/ -g -Wall -O0 -pedantic -pedantic-errors -m64 $(REAL) $(HULLINC) -DDEBUG
else
  CFLAGS=-Iobjs/ -03 -m64 $(REAL) $(HULLINC)
endif

CPP_OBJS=$(addprefix objs/, $(CPP_SRC:.cpp=.o))
C_OBJS=$(addprefix objs/, $(C_SRC:.c=.o))
LIBS=-lm -lstdc++ $(HULLLIB) 

default: dirs $(CPP_OBJS) $(EXE)

.PHONY: dirs clean print

print:
	@echo $(CPP_OBJS)

dirs:
	/bin/mkdir -p objs/

del:
	find ./ -iname "*.dump" -exec rm '{}' ';'

clean:
	/bin/rm -rf objs *~ $(EXE)
	/bin/rm -rf output/*
	find ./ -iname "*.dump" -exec rm '{}' ';'

$(EXE): $(CPP_OBJS) 
	$(CXX) -o $@ $^ $(LIBS)

objs/%.o: %.cpp
	$(CXX) $(CFLAGS) $< -c -o $@
